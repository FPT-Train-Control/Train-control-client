<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Test Line Chart</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<canvas id="chart" height="100"></canvas>
<script>
// Simulated example data
const data = [
  {
    "Tên Tàu": "Train A",
    "Vận Tốc": 55,
    "Ngày Đến": "2025-07-11",
    "Giờ Đến": "08:00:00"
  },
  {
    "Tên Tàu": "Train A",
    "Vận Tốc": 60,
    "Ngày Đến": "2025-07-11",
    "Giờ Đến": "09:00:00"
  },
  {
    "Tên Tàu": "Train B",
    "Vận Tốc": 45,
    "Ngày Đến": "2025-07-11",
    "Giờ Đến": "08:30:00"
  },
  {
    "Tên Tàu": "Train B",
    "Vận Tốc": 48,
    "Ngày Đến": "2025-07-11",
    "Giờ Đến": "09:30:00"
  }
];

const datasetsByTrain = {};
data.forEach(item => {
  const name = item["Tên Tàu"];
  const datetimeStr = `${item["Ngày Đến"]}T${item["Giờ Đến"]}`;
  const date = new Date(datetimeStr);
  const speed = item["Vận Tốc"];
  if (!datasetsByTrain[name]) datasetsByTrain[name] = [];
  datasetsByTrain[name].push({ x: date, y: speed });
});

const colors = ["#FF6600", "#007BFF"];

const datasets = Object.keys(datasetsByTrain).map((name, i) => ({
  label: name,
  data: datasetsByTrain[name].sort((a,b)=>a.x - b.x),
  borderColor: colors[i % colors.length],
  fill: false,
  tension: 0.2
}));

const ctx = document.getElementById("chart").getContext("2d");
new Chart(ctx, {
  type: "line",
  data: { datasets },
  options: {
    responsive: true,
    scales: {
      x: {
        type: "time",
        time: { tooltipFormat: "dd/MM/yyyy HH:mm" },
        title: { display: true, text: "Time" }
      },
      y: {
        beginAtZero: true,
        title: { display: true, text: "Speed (km/h)" }
      }
    }
  }
});
</script>
</body>
</html>
